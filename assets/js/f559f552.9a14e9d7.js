"use strict";(self.webpackChunkecharts_api_docs=self.webpackChunkecharts_api_docs||[]).push([[2548],{9195:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>h,frontMatter:()=>r,metadata:()=>a,toc:()=>d});var i=t(4848),s=t(8453);const r={},c="\u5e03\u5c40",a={id:"guide/modules/layout",title:"\u5e03\u5c40",description:"\u672c\u8282\u5185\u5bb9\u4e3b\u8981\u662f\u5173\u4e8e ECharts \u5e03\u5c40\u8ba1\u7b97\u76f8\u5173\u7684\u6280\u672f\u7b80\u8ff0\uff0c\u5e76\u5217\u4e3e\u4e00\u4e9b\u5e38\u7528\u7684\u5e03\u5c40\u7b97\u6cd5\u548c\u5e94\u7528\u6848\u4f8b\u3002",source:"@site/docs/0-guide/4-modules/1-layout.md",sourceDirName:"0-guide/4-modules",slug:"/guide/modules/layout",permalink:"/echarts-api-docs/docs/guide/modules/layout",draft:!1,unlisted:!1,editUrl:"https://github.com/wang1212/echarts-api-docs/tree/main/docs/0-guide/4-modules/1-layout.md",tags:[],version:"current",sidebarPosition:1,frontMatter:{},sidebar:"guideSidebar",previous:{title:"\u6570\u636e",permalink:"/echarts-api-docs/docs/guide/modules/data"},next:{title:"\u6e32\u67d3",permalink:"/echarts-api-docs/docs/guide/modules/render"}},l={},d=[{value:"\u5e03\u5c40\u673a\u5236",id:"\u5e03\u5c40\u673a\u5236",level:2},{value:"\u5e03\u5c40 APIs",id:"\u5e03\u5c40-apis",level:3},{value:"\u5168\u5c40\u5e03\u5c40\u4fe1\u606f",id:"\u5168\u5c40\u5e03\u5c40\u4fe1\u606f",level:4},{value:"\u6570\u636e\u9879\u5e03\u5c40\u4fe1\u606f",id:"\u6570\u636e\u9879\u5e03\u5c40\u4fe1\u606f",level:4},{value:"\u6ce8\u518c\u5e03\u5c40\u7b97\u6cd5",id:"\u6ce8\u518c\u5e03\u5c40\u7b97\u6cd5",level:3},{value:"\u5e38\u7528\u5e03\u5c40\u7b97\u6cd5",id:"\u5e38\u7528\u5e03\u5c40\u7b97\u6cd5",level:2},{value:"\u7b1b\u5361\u5c14\u5750\u6807\u7cfb",id:"\u7b1b\u5361\u5c14\u5750\u6807\u7cfb",level:3},{value:"\u6811\uff08Tree\uff09",id:"\u6811tree",level:3},{value:"\u529b\u5bfc\u5411\u5e03\u5c40",id:"\u529b\u5bfc\u5411\u5e03\u5c40",level:3}];function o(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",mermaid:"mermaid",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"\u5e03\u5c40",children:"\u5e03\u5c40"}),"\n",(0,i.jsx)(n.p,{children:"\u672c\u8282\u5185\u5bb9\u4e3b\u8981\u662f\u5173\u4e8e ECharts \u5e03\u5c40\u8ba1\u7b97\u76f8\u5173\u7684\u6280\u672f\u7b80\u8ff0\uff0c\u5e76\u5217\u4e3e\u4e00\u4e9b\u5e38\u7528\u7684\u5e03\u5c40\u7b97\u6cd5\u548c\u5e94\u7528\u6848\u4f8b\u3002"}),"\n",(0,i.jsx)(n.h2,{id:"\u5e03\u5c40\u673a\u5236",children:"\u5e03\u5c40\u673a\u5236"}),"\n",(0,i.jsx)(n.mermaid,{value:"---\ntitle: echarts layout mechanism\n---\nflowchart LR\n    Model\n\n    Model--\x3eLayout:::keyNode--\x3eView\n\n    classDef keyNode stroke-width: 4px"}),"\n",(0,i.jsx)(n.p,{children:"\u5e03\u5c40\u8ba1\u7b97\u662f\u4e00\u4e2a\u76f8\u5bf9\u72ec\u7acb\u7684\u6a21\u5757\uff0c\u548c\u5176\u5b83\u6a21\u5757\u8026\u5408\u6027\u8f83\u4f4e\uff0c\u5c5e\u4e8e\u6570\u636e\u5904\u7406\u5230\u89c6\u56fe\u6e32\u67d3\u4e2d\u95f4\u7684\u4e00\u4e2a\u91cd\u8981\u73af\u8282\u3002"}),"\n",(0,i.jsx)(n.h3,{id:"\u5e03\u5c40-apis",children:"\u5e03\u5c40 APIs"}),"\n",(0,i.jsx)(n.p,{children:"\u5e03\u5c40\u8ba1\u7b97\u6d89\u53ca\u5230\u5b58\u50a8\u5e03\u5c40\u8ba1\u7b97\u7684\u7ed3\u679c\u4fe1\u606f\uff0c\u4ee5\u53ca\u5728\u89c6\u56fe\u5c42\u83b7\u53d6\u5e03\u5c40\u4fe1\u606f\u5e76\u5b8c\u6210\u56fe\u5f62\u6e32\u67d3\u76f8\u5173\u64cd\u4f5c\u3002\u76f8\u5173 APIs \u90fd\u662f\u6570\u636e\u96c6\uff08SeriesData\uff09\u5b9e\u4f8b\u4e0a\u7684\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\u5168\u5c40\u5e03\u5c40\u4fe1\u606f\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/apache/echarts/blob/5.3.3/src/data/SeriesData.ts#L1271",children:(0,i.jsx)(n.code,{children:"setLayout()"})})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/apache/echarts/blob/5.3.3/src/data/SeriesData.ts#L1280",children:(0,i.jsx)(n.code,{children:"getLayout()"})})}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\u6570\u636e\u9879\u5e03\u5c40\u4fe1\u606f\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/apache/echarts/blob/5.3.3/src/data/SeriesData.ts#L1294",children:(0,i.jsx)(n.code,{children:"setItemLayout()"})})}),"\n",(0,i.jsx)(n.li,{children:(0,i.jsx)(n.a,{href:"https://github.com/apache/echarts/blob/5.3.3/src/data/SeriesData.ts#L1287",children:(0,i.jsx)(n.code,{children:"getItemLayout()"})})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"\u5e03\u5c40\u4fe1\u606f\u5206\u4e3a\u4e24\u7c7b\uff1a\u5168\u5c40\u7684\u548c\u7279\u5b9a\u6570\u636e\u9879\u7684\u3002"}),"\n",(0,i.jsx)(n.h4,{id:"\u5168\u5c40\u5e03\u5c40\u4fe1\u606f",children:"\u5168\u5c40\u5e03\u5c40\u4fe1\u606f"}),"\n",(0,i.jsxs)(n.p,{children:["\u901a\u5e38\uff0c\u5168\u5c40\u7684\u5e03\u5c40\u53c2\u6570\u662f\u76f4\u63a5\u8bbe\u7f6e\u5728\u7cfb\u5217\uff08series\uff09\u4e0a\u7684\uff0c\u6bd4\u5982",(0,i.jsxs)(n.a,{href:"https://echarts.apache.org/zh/option.html#series-pie.center",children:["\u997c\u56fe\u7684 ",(0,i.jsx)(n.code,{children:"center"})," \u914d\u7f6e"]}),"\uff0c\u9700\u8981\u5c06\u5176\u6362\u7b97\u4e3a\u5b9e\u9645\u7684\u5750\u6807\u5e76\u5b58\u50a8\u4e0b\u6765\u3002"]}),"\n",(0,i.jsx)(n.p,{children:"\u793a\u4f8b\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:'title="https://github.com/apache/echarts/blob/5.3.3/src/chart/pie/pieLayout.ts#L68"',children:"export function getBasicPieLayout(seriesModel: PieSeriesModel, api: ExtensionAPI):\n    Pick<SectorShape, 'cx' | 'cy' | 'r' | 'r0'> {\n    const viewRect = getViewRect(seriesModel, api);\n\n    // highlight-next-line\n    let center = seriesModel.get('center');\n    let radius = seriesModel.get('radius');\n\n    if (!zrUtil.isArray(radius)) {\n        radius = [0, radius];\n    }\n    if (!zrUtil.isArray(center)) {\n        center = [center, center];\n    }\n    const width = parsePercent(viewRect.width, api.getWidth());\n    const height = parsePercent(viewRect.height, api.getHeight());\n    const size = Math.min(width, height);\n    const cx = parsePercent(center[0], width) + viewRect.x;\n    const cy = parsePercent(center[1], height) + viewRect.y;\n    const r0 = parsePercent(radius[0], size / 2);\n    const r = parsePercent(radius[1], size / 2);\n    return {\n        cx,\n        cy,\n        r0,\n        r\n    };\n}\n\nexport default function pieLayout(\n    seriesType: 'pie',\n    ecModel: GlobalModel,\n    api: ExtensionAPI\n) {\n    ecModel.eachSeriesByType(seriesType, function (seriesModel: PieSeriesModel) {\n        const data = seriesModel.getData();\n        const valueDim = data.mapDimension('value');\n        const viewRect = getViewRect(seriesModel, api);\n\n        const { cx, cy, r, r0 } = getBasicPieLayout(seriesModel, api);\n\n        // ...\n\n        // highlight-next-line\n        data.setLayout({ viewRect, r });\n\n        // ...\n    });\n}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"\u6570\u636e\u9879\u5e03\u5c40\u4fe1\u606f",children:"\u6570\u636e\u9879\u5e03\u5c40\u4fe1\u606f"}),"\n",(0,i.jsx)(n.p,{children:"\u53e6\u4e00\u65b9\u9762\uff0c\u91cd\u70b9\u5728\u4e8e\u6570\u636e\u9879\u7684\u5e03\u5c40\u4fe1\u606f\uff0c\u4e00\u822c\u4e00\u4e2a\u6570\u636e\u9879\u5bf9\u5e94\u4e00\u4e2a\u56fe\u5f62\uff0c\u56fe\u5f62\u7684\u4f4d\u7f6e\u4fe1\u606f\u8868\u8fbe\u4e86\u6570\u636e\u7684\u5206\u5e03\u548c\u8d8b\u52bf\u7b49\u91cd\u8981\u4fe1\u606f\u3002"}),"\n",(0,i.jsx)(n.p,{children:"\u7ed3\u5408\u5168\u5c40\u7684\u5e03\u5c40\u4fe1\u606f\u548c\u4e00\u4e9b\u7279\u5b9a\u7684\u5e03\u5c40\u7b97\u6cd5\u6765\u5b8c\u6210\u5bf9\u6570\u636e\u9879\u7684\u5e03\u5c40\u8ba1\u7b97\uff0c\u4ee5\u997c\u56fe\u4e3a\u4f8b\uff1a"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:'title="https://github.com/apache/echarts/blob/5.3.3/src/chart/pie/pieLayout.ts#L68"',children:"export default function pieLayout(\n    seriesType: 'pie',\n    ecModel: GlobalModel,\n    api: ExtensionAPI\n) {\n    ecModel.eachSeriesByType(seriesType, function (seriesModel: PieSeriesModel) {\n        const data = seriesModel.getData();\n\n        // ...\n\n        data.each(valueDim, function (value: number, idx: number) {\n            let angle;\n\n            // ...\n\n            const endAngle = currentAngle + dir * angle;\n            // highlight-start\n            data.setItemLayout(idx, {\n                angle: angle,\n                startAngle: currentAngle,\n                endAngle: endAngle,\n                clockwise: clockwise,\n                cx: cx,\n                cy: cy,\n                r0: r0,\n                r: roseType\n                    ? linearMap(value, extent, [r0, r])\n                    : r\n            });\n            // highlight-end\n\n            currentAngle = endAngle;\n        });\n\n        // ...\n    });\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:"\u4ee5\u4e0a\u5c31\u662f\u4ee5\u997c\u56fe\u4e3a\u4f8b\u89e3\u91ca\u4e86\u4e24\u7c7b\u5e03\u5c40\u8ba1\u7b97\u7684\u8fc7\u7a0b\uff0c\u76f8\u5bf9\u6765\u8bf4\u6bd4\u8f83\u7b80\u5355\u3002"}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["\u6570\u636e\u96c6\u5b9e\u4f8b\u76f8\u5173\u64cd\u4f5c\u53ef\u4ee5\u53c2\u8003",(0,i.jsx)(n.a,{href:"/echarts-api-docs/docs/guide/modules/data#%E8%AE%BF%E9%97%AE%E7%B3%BB%E5%88%97%E6%95%B0%E6%8D%AE%E9%9B%86%E5%AE%9E%E4%BE%8B",children:"\u8bbf\u95ee\u7cfb\u5217\u6570\u636e\u96c6\u5b9e\u4f8b"}),"\u3002"]})}),"\n",(0,i.jsx)(n.h3,{id:"\u6ce8\u518c\u5e03\u5c40\u7b97\u6cd5",children:"\u6ce8\u518c\u5e03\u5c40\u7b97\u6cd5"}),"\n",(0,i.jsxs)(n.p,{children:["\u5e03\u5c40\u7b97\u6cd5\u7684\u51fd\u6570\u5e76\u4e0d\u76f4\u63a5\u7531\u6570\u636e\u5c42\uff08Model\uff09\u6216\u8005\u89c6\u56fe\u5c42\uff08View\uff09\u8c03\u7528\uff0c\u800c\u662f\u7531 ECharts \u7684\u6838\u5fc3\u6d41\u7a0b\u8fdb\u884c\u8c03\u5ea6\uff0c\u9700\u8981\u4e8b\u5148\u4f7f\u7528 ",(0,i.jsx)(n.code,{children:"registerLayout()"})," API \u8fdb\u884c\u6ce8\u518c\uff0c\u4ee5\u997c\u56fe\u4e3a\u4f8b\uff1a"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",metastring:'title="https://github.com/apache/echarts/blob/5.3.3/src/chart/pie/install.ts#L36"',children:"export default function pieLayout(\n    seriesType: 'pie',\n    ecModel: GlobalModel,\n    api: ExtensionAPI\n) {\n    ecModel.eachSeriesByType(seriesType, function (seriesModel: PieSeriesModel) {\n        // TODO\n    });\n}\n\nexport function install(registers: EChartsExtensionInstallRegisters) {\n    registers.registerChartView(PieView);\n    registers.registerSeriesModel(PieSeriesModel);\n\n    createLegacyDataSelectAction('pie', registers.registerAction);\n\n    // highlight-next-line\n    registers.registerLayout(curry(pieLayout, 'pie'));\n    registers.registerProcessor(dataFilter('pie'));\n    registers.registerProcessor(negativeDataFilter('pie'));\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:["\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c",(0,i.jsxs)(n.strong,{children:["\u8fd9\u91cc\u7684 ",(0,i.jsx)(n.code,{children:"seriesType"})," \u9700\u8981\u76f4\u63a5\u6307\u5b9a\u4e3a ",(0,i.jsx)(n.code,{children:"'pie'"}),"\uff0c\u5426\u5219\u5c06\u65e0\u6cd5\u6210\u529f\u5b8c\u6210\u997c\u56fe\u7684\u5e03\u5c40\u8ba1\u7b97"]}),"\u3002"]}),"\n",(0,i.jsx)(n.admonition,{type:"tip",children:(0,i.jsxs)(n.p,{children:["\u76f8\u5173\u5185\u5bb9\u53ef\u4ee5\u53c2\u8003",(0,i.jsx)(n.a,{href:"/echarts-api-docs/docs/guide/echarts-plugin#%E6%89%A9%E5%B1%95-apis",children:"\u63d2\u4ef6\u673a\u5236\u4e2d\u7684\u6269\u5c55 APIs"}),"\u3002"]})}),"\n",(0,i.jsx)(n.h2,{id:"\u5e38\u7528\u5e03\u5c40\u7b97\u6cd5",children:"\u5e38\u7528\u5e03\u5c40\u7b97\u6cd5"}),"\n",(0,i.jsx)(n.h3,{id:"\u7b1b\u5361\u5c14\u5750\u6807\u7cfb",children:"\u7b1b\u5361\u5c14\u5750\u6807\u7cfb"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"WIP"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u6811tree",children:"\u6811\uff08Tree\uff09"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"WIP"}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"\u529b\u5bfc\u5411\u5e03\u5c40",children:"\u529b\u5bfc\u5411\u5e03\u5c40"}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:"WIP"}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>c,x:()=>a});var i=t(6540);const s={},r=i.createContext(s);function c(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:c(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);